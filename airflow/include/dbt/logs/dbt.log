[0m00:19:46.845766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2e95580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2e94e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2e968d0>]}


============================== 00:19:46.866255 | 861fc2ea-a47d-498b-9f85-0ae43093bbb1 ==============================
[0m00:19:46.866255 [info ] [MainThread]: Running with dbt=1.11.3
[0m00:19:46.866797 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'write_json': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/usr/local/airflow/include/dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'printer_width': '80', 'fail_fast': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'target_path': 'None'}
[0m00:19:46.938189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '861fc2ea-a47d-498b-9f85-0ae43093bbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2821be0>]}
[0m00:19:46.960368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '861fc2ea-a47d-498b-9f85-0ae43093bbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5334fe0>]}
[0m00:19:46.960877 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m00:19:46.990951 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m00:19:46.991558 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:19:46.991899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '861fc2ea-a47d-498b-9f85-0ae43093bbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3288440>]}
[0m00:19:47.490712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '861fc2ea-a47d-498b-9f85-0ae43093bbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1775670>]}
[0m00:19:47.524712 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/include/dbt/target/manifest.json
[0m00:19:47.525681 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/include/dbt/target/semantic_manifest.json
[0m00:19:47.542923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '861fc2ea-a47d-498b-9f85-0ae43093bbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1321850>]}
[0m00:19:47.543185 [info ] [MainThread]: Found 2 models, 1 seed, 1 test, 464 macros
[0m00:19:47.543516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '861fc2ea-a47d-498b-9f85-0ae43093bbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1789e20>]}
[0m00:19:47.544220 [info ] [MainThread]: 
[0m00:19:47.544457 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:19:47.544633 [info ] [MainThread]: 
[0m00:19:47.544886 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:19:47.545349 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:19:47.561632 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:19:47.561848 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:19:47.562037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:47.793598 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "dbt-postgres" to address: Name or service not known

[0m00:19:47.804527 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:19:47.805454 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:19:47.806115 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m00:19:47.806473 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:19:47.806823 [debug] [ThreadPool]: On list_dbt: No close available on handle
[0m00:19:47.807667 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:19:47.808118 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m00:19:47.808410 [info ] [MainThread]: 
[0m00:19:47.808747 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m00:19:47.809326 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "dbt-postgres" to address: Name or service not known
  
[0m00:19:47.810857 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.98612916, "process_in_blocks": "0", "process_kernel_time": 0.157398, "process_mem_max_rss": "125928", "process_out_blocks": "1781", "process_user_time": 1.646712}
[0m00:19:47.811545 [debug] [MainThread]: Command `dbt seed` failed at 00:19:47.811424 after 0.99 seconds
[0m00:19:47.812491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2991460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1894b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb13e3020>]}
[0m00:19:47.813197 [debug] [MainThread]: Flushing usage events
[0m00:19:48.964059 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:21:22.549709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce10a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce12f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce8ed10>]}


============================== 21:21:22.552133 | 49c2d1c5-5ced-4735-8b59-638624eb3998 ==============================
[0m21:21:22.552133 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:21:22.552401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/logs', 'profiles_dir': '/Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:21:22.554484 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.postgres'
[0m21:21:22.554700 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "airflow_agents_dbt", target "dev" invalid: Runtime Error
    Could not find adapter type postgres!
[0m21:21:22.564061 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.044173706, "process_in_blocks": "0", "process_kernel_time": 0.152075, "process_mem_max_rss": "102416384", "process_out_blocks": "0", "process_user_time": 0.515598}
[0m21:21:22.564355 [debug] [MainThread]: Command `dbt compile` failed at 21:21:22.564301 after 0.04 seconds
[0m21:21:22.564544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce0eb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce8ea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cea6b50>]}
[0m21:21:22.564695 [debug] [MainThread]: Flushing usage events
[0m21:21:23.546348 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:28:24.324799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109de13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0a3e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0a3990>]}


============================== 21:28:24.343677 | a59e3c1b-160e-4309-ba12-503e63ccbe32 ==============================
[0m21:28:24.343677 [info ] [MainThread]: Running with dbt=1.11.3
[0m21:28:24.344255 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'empty': 'False', 'fail_fast': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None', 'warn_error': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'printer_width': '80', 'introspect': 'True', 'log_format': 'default', 'log_path': '/Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/logs', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True'}
[0m21:28:24.431509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a59e3c1b-160e-4309-ba12-503e63ccbe32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0cc250>]}
[0m21:28:24.454299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a59e3c1b-160e-4309-ba12-503e63ccbe32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e6010>]}
[0m21:28:24.455222 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:28:24.518224 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m21:28:24.577239 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:28:24.577713 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:28:24.578066 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:28:24.597313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a59e3c1b-160e-4309-ba12-503e63ccbe32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa20750>]}
[0m21:28:24.629150 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/manifest.json
[0m21:28:24.630895 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/semantic_manifest.json
[0m21:28:24.656482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a59e3c1b-160e-4309-ba12-503e63ccbe32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b14cd50>]}
[0m21:28:24.657042 [info ] [MainThread]: Found 2 models, 1 seed, 1 test, 464 macros
[0m21:28:24.657529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a59e3c1b-160e-4309-ba12-503e63ccbe32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a538890>]}
[0m21:28:24.658571 [info ] [MainThread]: 
[0m21:28:24.658970 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:28:24.659355 [info ] [MainThread]: 
[0m21:28:24.659843 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:28:24.661588 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_analytics'
[0m21:28:24.692891 [debug] [ThreadPool]: Using postgres connection "list_dbt_analytics"
[0m21:28:24.693333 [debug] [ThreadPool]: On list_dbt_analytics: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "list_dbt_analytics"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:28:24.693695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:24.695323 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "dbt-postgres" to address: nodename nor servname provided, or not known

[0m21:28:24.695787 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "list_dbt_analytics"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:28:24.696129 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m21:28:24.696501 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_relations_without_caching
[0m21:28:24.696843 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m21:28:24.697259 [debug] [ThreadPool]: On list_dbt_analytics: No close available on handle
[0m21:28:24.697936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:28:24.698391 [debug] [MainThread]: Connection 'list_dbt_analytics' was properly closed.
[0m21:28:24.698872 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "dbt-postgres" to address: nodename nor servname provided, or not known
  
[0m21:28:24.700517 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.40607828, "process_in_blocks": "0", "process_kernel_time": 0.190109, "process_mem_max_rss": "142704640", "process_out_blocks": "0", "process_user_time": 0.935737}
[0m21:28:24.701138 [debug] [MainThread]: Command `dbt compile` failed at 21:28:24.700912 after 0.41 seconds
[0m21:28:24.701525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0967d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a095ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1ca910>]}
[0m21:28:24.701908 [debug] [MainThread]: Flushing usage events
[0m21:28:24.707006 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:28:55.864512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d486990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d514b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d515650>]}


============================== 21:28:55.884049 | e581616e-58b0-4aa2-9331-7f11f3588576 ==============================
[0m21:28:55.884049 [info ] [MainThread]: Running with dbt=1.11.3
[0m21:28:55.884582 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'debug': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'static_parser': 'True', 'log_path': '/Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/logs', 'target_path': 'None', 'warn_error': 'None', 'introspect': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'invocation_command': 'dbt compile', 'profiles_dir': '/Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt', 'log_format': 'default', 'cache_selected_only': 'False', 'quiet': 'False', 'partial_parse': 'True'}
[0m21:28:55.970715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e581616e-58b0-4aa2-9331-7f11f3588576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d91d050>]}
[0m21:28:55.994672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e581616e-58b0-4aa2-9331-7f11f3588576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8bdf10>]}
[0m21:28:55.995756 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:28:56.044311 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m21:28:56.085613 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:28:56.086130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e581616e-58b0-4aa2-9331-7f11f3588576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6700d0>]}
[0m21:28:56.550926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e581616e-58b0-4aa2-9331-7f11f3588576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e613d10>]}
[0m21:28:56.581283 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/manifest.json
[0m21:28:56.582676 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/semantic_manifest.json
[0m21:28:56.606860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e581616e-58b0-4aa2-9331-7f11f3588576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaeb2d0>]}
[0m21:28:56.607398 [info ] [MainThread]: Found 2 models, 1 seed, 1 test, 464 macros
[0m21:28:56.607810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e581616e-58b0-4aa2-9331-7f11f3588576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e919c10>]}
[0m21:28:56.608781 [info ] [MainThread]: 
[0m21:28:56.609188 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:28:56.609578 [info ] [MainThread]: 
[0m21:28:56.610051 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:28:56.611883 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_analytics'
[0m21:28:56.638816 [debug] [ThreadPool]: Using postgres connection "list_dbt_analytics"
[0m21:28:56.639249 [debug] [ThreadPool]: On list_dbt_analytics: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "list_dbt_analytics"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:28:56.639604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:56.664706 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5433 failed: Operation not permitted
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5433 failed: Operation not permitted
	Is the server running on that host and accepting TCP/IP connections?

[0m21:28:56.665631 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "list_dbt_analytics"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:28:56.666036 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m21:28:56.666407 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_relations_without_caching
[0m21:28:56.666745 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m21:28:56.667092 [debug] [ThreadPool]: On list_dbt_analytics: No close available on handle
[0m21:28:56.667592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:28:56.667985 [debug] [MainThread]: Connection 'list_dbt_analytics' was properly closed.
[0m21:28:56.668423 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5433 failed: Operation not permitted
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5433 failed: Operation not permitted
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m21:28:56.670371 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.8466969, "process_in_blocks": "0", "process_kernel_time": 0.208615, "process_mem_max_rss": "159547392", "process_out_blocks": "0", "process_user_time": 1.368941}
[0m21:28:56.670979 [debug] [MainThread]: Command `dbt compile` failed at 21:28:56.670755 after 0.85 seconds
[0m21:28:56.671362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d515150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d515bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd73990>]}
[0m21:28:56.671752 [debug] [MainThread]: Flushing usage events
[0m21:28:56.675547 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:29:24.185126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10931b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109be1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bff7990>]}


============================== 21:29:24.200606 | c393f027-06ce-4868-823a-3f80b8bc2ddd ==============================
[0m21:29:24.200606 [info ] [MainThread]: Running with dbt=1.11.3
[0m21:29:24.200892 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_path': '/Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/logs', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'write_json': 'True', 'use_colors': 'True', 'printer_width': '80', 'fail_fast': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'partial_parse': 'True', 'introspect': 'True', 'profiles_dir': '/Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt', 'empty': 'False', 'debug': 'False', 'static_parser': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt compile', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:29:24.275879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c393f027-06ce-4868-823a-3f80b8bc2ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2a9d50>]}
[0m21:29:24.298238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c393f027-06ce-4868-823a-3f80b8bc2ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109336650>]}
[0m21:29:24.298837 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:29:24.344069 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m21:29:24.392721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:29:24.392953 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:29:24.393074 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:29:24.412108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c393f027-06ce-4868-823a-3f80b8bc2ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9acb50>]}
[0m21:29:24.443372 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/manifest.json
[0m21:29:24.444193 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/semantic_manifest.json
[0m21:29:24.468760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c393f027-06ce-4868-823a-3f80b8bc2ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c317e90>]}
[0m21:29:24.468980 [info ] [MainThread]: Found 2 models, 1 seed, 1 test, 464 macros
[0m21:29:24.469173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c393f027-06ce-4868-823a-3f80b8bc2ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c39bed0>]}
[0m21:29:24.469897 [info ] [MainThread]: 
[0m21:29:24.470039 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:29:24.470148 [info ] [MainThread]: 
[0m21:29:24.470357 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:29:24.471900 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_analytics'
[0m21:29:24.496607 [debug] [ThreadPool]: Using postgres connection "list_dbt_analytics"
[0m21:29:24.496800 [debug] [ThreadPool]: On list_dbt_analytics: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "list_dbt_analytics"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:29:24.496923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:24.630741 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.134 seconds
[0m21:29:24.631654 [debug] [ThreadPool]: On list_dbt_analytics: ROLLBACK
[0m21:29:24.632806 [debug] [ThreadPool]: On list_dbt_analytics: Close
[0m21:29:24.635926 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:24.636226 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:29:24.636455 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:29:24.651727 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m21:29:24.652403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c393f027-06ce-4868-823a-3f80b8bc2ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b901a50>]}
[0m21:29:24.652682 [debug] [MainThread]: On master: ROLLBACK
[0m21:29:24.653385 [debug] [MainThread]: On master: Close
[0m21:29:24.655840 [debug] [Thread-1 (]: Began running node model.airflow_agents_dbt.run_events
[0m21:29:24.656105 [debug] [Thread-2 (]: Began running node seed.airflow_agents_dbt.raw_customers
[0m21:29:24.656390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_analytics, now model.airflow_agents_dbt.run_events)
[0m21:29:24.656668 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.airflow_agents_dbt.raw_customers'
[0m21:29:24.656877 [debug] [Thread-1 (]: Began compiling node model.airflow_agents_dbt.run_events
[0m21:29:24.657097 [debug] [Thread-2 (]: Began compiling node seed.airflow_agents_dbt.raw_customers
[0m21:29:24.661577 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_agents_dbt.run_events"
[0m21:29:24.662703 [debug] [Thread-2 (]: Began executing node seed.airflow_agents_dbt.raw_customers
[0m21:29:24.663177 [debug] [Thread-2 (]: Finished running node seed.airflow_agents_dbt.raw_customers
[0m21:29:24.663493 [debug] [Thread-4 (]: Began running node model.airflow_agents_dbt.customer_summary
[0m21:29:24.663778 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_agents_dbt.customer_summary'
[0m21:29:24.663981 [debug] [Thread-4 (]: Began compiling node model.airflow_agents_dbt.customer_summary
[0m21:29:24.665468 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_agents_dbt.customer_summary"
[0m21:29:24.665758 [debug] [Thread-1 (]: Began executing node model.airflow_agents_dbt.run_events
[0m21:29:24.666141 [debug] [Thread-1 (]: Finished running node model.airflow_agents_dbt.run_events
[0m21:29:24.666357 [debug] [Thread-4 (]: Began executing node model.airflow_agents_dbt.customer_summary
[0m21:29:24.666665 [debug] [Thread-4 (]: Finished running node model.airflow_agents_dbt.customer_summary
[0m21:29:24.667012 [debug] [Thread-2 (]: Began running node test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67
[0m21:29:24.667275 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.airflow_agents_dbt.raw_customers, now test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67)
[0m21:29:24.667491 [debug] [Thread-2 (]: Began compiling node test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67
[0m21:29:24.700525 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67"
[0m21:29:24.701069 [debug] [Thread-2 (]: Began executing node test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67
[0m21:29:24.701376 [debug] [Thread-2 (]: Finished running node test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67
[0m21:29:24.701862 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:24.701991 [debug] [MainThread]: Connection 'model.airflow_agents_dbt.run_events' was properly closed.
[0m21:29:24.702097 [debug] [MainThread]: Connection 'test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67' was properly closed.
[0m21:29:24.702191 [debug] [MainThread]: Connection 'model.airflow_agents_dbt.customer_summary' was properly closed.
[0m21:29:24.702562 [debug] [MainThread]: Command end result
[0m21:29:24.710796 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/manifest.json
[0m21:29:24.711526 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/semantic_manifest.json
[0m21:29:24.714271 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/run_results.json
[0m21:29:24.715552 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.5576026, "process_in_blocks": "0", "process_kernel_time": 0.159062, "process_mem_max_rss": "152797184", "process_out_blocks": "0", "process_user_time": 0.981847}
[0m21:29:24.715729 [debug] [MainThread]: Command `dbt compile` succeeded at 21:29:24.715696 after 0.56 seconds
[0m21:29:24.715874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dbbd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc07d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095d6910>]}
[0m21:29:24.716022 [debug] [MainThread]: Flushing usage events
[0m21:29:25.678697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:29:41.786590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092af790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb2ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bedb990>]}


============================== 21:29:41.788844 | 99677fee-fab1-4634-b477-211dfb5455e1 ==============================
[0m21:29:41.788844 [info ] [MainThread]: Running with dbt=1.11.3
[0m21:29:41.789103 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'introspect': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'log_path': '/Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/logs', 'write_json': 'True', 'printer_width': '80', 'version_check': 'True', 'no_print': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt', 'quiet': 'False', 'warn_error': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile', 'use_experimental_parser': 'False', 'debug': 'False', 'empty': 'False', 'log_cache_events': 'False'}
[0m21:29:41.856300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99677fee-fab1-4634-b477-211dfb5455e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf27b90>]}
[0m21:29:41.879953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99677fee-fab1-4634-b477-211dfb5455e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ee310>]}
[0m21:29:41.880614 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:29:41.924665 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m21:29:41.972419 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:29:41.972626 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:29:41.972747 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:29:41.991756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99677fee-fab1-4634-b477-211dfb5455e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce81250>]}
[0m21:29:42.023132 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/manifest.json
[0m21:29:42.023939 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/semantic_manifest.json
[0m21:29:42.032787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99677fee-fab1-4634-b477-211dfb5455e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf8dd10>]}
[0m21:29:42.033016 [info ] [MainThread]: Found 2 models, 1 seed, 1 test, 464 macros
[0m21:29:42.033150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99677fee-fab1-4634-b477-211dfb5455e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd77290>]}
[0m21:29:42.033912 [info ] [MainThread]: 
[0m21:29:42.034048 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:29:42.034154 [info ] [MainThread]: 
[0m21:29:42.034360 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:29:42.035816 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_analytics'
[0m21:29:42.055432 [debug] [ThreadPool]: Using postgres connection "list_dbt_analytics"
[0m21:29:42.055625 [debug] [ThreadPool]: On list_dbt_analytics: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "list_dbt_analytics"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:29:42.055741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:42.080148 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.024 seconds
[0m21:29:42.080734 [debug] [ThreadPool]: On list_dbt_analytics: ROLLBACK
[0m21:29:42.081896 [debug] [ThreadPool]: On list_dbt_analytics: Close
[0m21:29:42.083794 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:42.083971 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:29:42.084119 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:29:42.096695 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m21:29:42.097183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99677fee-fab1-4634-b477-211dfb5455e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d23e010>]}
[0m21:29:42.097371 [debug] [MainThread]: On master: ROLLBACK
[0m21:29:42.097860 [debug] [MainThread]: On master: Close
[0m21:29:42.100125 [debug] [Thread-1 (]: Began running node model.airflow_agents_dbt.run_events
[0m21:29:42.100321 [debug] [Thread-2 (]: Began running node seed.airflow_agents_dbt.raw_customers
[0m21:29:42.100498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_analytics, now model.airflow_agents_dbt.run_events)
[0m21:29:42.100694 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.airflow_agents_dbt.raw_customers'
[0m21:29:42.100839 [debug] [Thread-1 (]: Began compiling node model.airflow_agents_dbt.run_events
[0m21:29:42.100966 [debug] [Thread-2 (]: Began compiling node seed.airflow_agents_dbt.raw_customers
[0m21:29:42.104033 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_agents_dbt.run_events"
[0m21:29:42.104782 [debug] [Thread-2 (]: Began executing node seed.airflow_agents_dbt.raw_customers
[0m21:29:42.105111 [debug] [Thread-2 (]: Finished running node seed.airflow_agents_dbt.raw_customers
[0m21:29:42.105370 [debug] [Thread-4 (]: Began running node model.airflow_agents_dbt.customer_summary
[0m21:29:42.105644 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_agents_dbt.customer_summary'
[0m21:29:42.105783 [debug] [Thread-1 (]: Began executing node model.airflow_agents_dbt.run_events
[0m21:29:42.105915 [debug] [Thread-4 (]: Began compiling node model.airflow_agents_dbt.customer_summary
[0m21:29:42.106144 [debug] [Thread-1 (]: Finished running node model.airflow_agents_dbt.run_events
[0m21:29:42.107132 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_agents_dbt.customer_summary"
[0m21:29:42.107406 [debug] [Thread-4 (]: Began executing node model.airflow_agents_dbt.customer_summary
[0m21:29:42.107651 [debug] [Thread-4 (]: Finished running node model.airflow_agents_dbt.customer_summary
[0m21:29:42.107907 [debug] [Thread-2 (]: Began running node test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67
[0m21:29:42.108585 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.airflow_agents_dbt.raw_customers, now test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67)
[0m21:29:42.108728 [debug] [Thread-2 (]: Began compiling node test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67
[0m21:29:42.136869 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67"
[0m21:29:42.137235 [debug] [Thread-2 (]: Began executing node test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67
[0m21:29:42.137497 [debug] [Thread-2 (]: Finished running node test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67
[0m21:29:42.137947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:42.138077 [debug] [MainThread]: Connection 'model.airflow_agents_dbt.run_events' was properly closed.
[0m21:29:42.138182 [debug] [MainThread]: Connection 'test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67' was properly closed.
[0m21:29:42.138268 [debug] [MainThread]: Connection 'model.airflow_agents_dbt.customer_summary' was properly closed.
[0m21:29:42.138591 [debug] [MainThread]: Command end result
[0m21:29:42.146281 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/manifest.json
[0m21:29:42.146967 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/semantic_manifest.json
[0m21:29:42.149623 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/run_results.json
[0m21:29:42.151031 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.3928795, "process_in_blocks": "0", "process_kernel_time": 0.151334, "process_mem_max_rss": "139755520", "process_out_blocks": "0", "process_user_time": 0.941726}
[0m21:29:42.151198 [debug] [MainThread]: Command `dbt compile` succeeded at 21:29:42.151166 after 0.39 seconds
[0m21:29:42.151336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dffd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e049d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfa6bd0>]}
[0m21:29:42.151481 [debug] [MainThread]: Flushing usage events
[0m21:29:42.935336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:29:52.496005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3fb190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d407f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d407fd0>]}


============================== 21:29:52.498714 | 890f4b10-c930-4e43-982d-89d5ac09d8bc ==============================
[0m21:29:52.498714 [info ] [MainThread]: Running with dbt=1.11.3
[0m21:29:52.499484 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'static_parser': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/logs', 'quiet': 'False', 'debug': 'False', 'profiles_dir': '/Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt', 'log_cache_events': 'False', 'warn_error': 'None', 'version_check': 'True', 'log_format': 'default', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run', 'no_print': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'empty': 'False', 'target_path': 'None', 'fail_fast': 'False'}
[0m21:29:52.568188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '890f4b10-c930-4e43-982d-89d5ac09d8bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6c7e90>]}
[0m21:29:52.591536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '890f4b10-c930-4e43-982d-89d5ac09d8bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a731a50>]}
[0m21:29:52.592194 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:29:52.636122 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m21:29:52.684323 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:29:52.684524 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:29:52.684662 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:29:52.703389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '890f4b10-c930-4e43-982d-89d5ac09d8bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e31ff50>]}
[0m21:29:52.734516 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/manifest.json
[0m21:29:52.735363 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/semantic_manifest.json
[0m21:29:52.747480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '890f4b10-c930-4e43-982d-89d5ac09d8bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e39c050>]}
[0m21:29:52.747677 [info ] [MainThread]: Found 2 models, 1 seed, 1 test, 464 macros
[0m21:29:52.747825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '890f4b10-c930-4e43-982d-89d5ac09d8bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3fa1d0>]}
[0m21:29:52.748542 [info ] [MainThread]: 
[0m21:29:52.748678 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:29:52.748787 [info ] [MainThread]: 
[0m21:29:52.748997 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:29:52.750405 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m21:29:52.773979 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m21:29:52.774195 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m21:29:52.774310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:52.798386 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.024 seconds
[0m21:29:52.798965 [debug] [ThreadPool]: On list_dbt: Close
[0m21:29:52.799254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_analytics)
[0m21:29:52.799439 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "analytics"
"
[0m21:29:52.801455 [debug] [ThreadPool]: Using postgres connection "create_dbt_analytics"
[0m21:29:52.801577 [debug] [ThreadPool]: On create_dbt_analytics: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "create_dbt_analytics"} */
create schema if not exists "analytics"
[0m21:29:52.801677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:52.812668 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.011 seconds
[0m21:29:52.813059 [debug] [ThreadPool]: On create_dbt_analytics: COMMIT
[0m21:29:52.813199 [debug] [ThreadPool]: Using postgres connection "create_dbt_analytics"
[0m21:29:52.813320 [debug] [ThreadPool]: On create_dbt_analytics: COMMIT
[0m21:29:52.815394 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m21:29:52.815524 [debug] [ThreadPool]: On create_dbt_analytics: Close
[0m21:29:52.816027 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_analytics, now list_dbt_analytics)
[0m21:29:52.818452 [debug] [ThreadPool]: Using postgres connection "list_dbt_analytics"
[0m21:29:52.818602 [debug] [ThreadPool]: On list_dbt_analytics: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "list_dbt_analytics"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:29:52.818721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:52.832779 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m21:29:52.833262 [debug] [ThreadPool]: On list_dbt_analytics: ROLLBACK
[0m21:29:52.833743 [debug] [ThreadPool]: On list_dbt_analytics: Close
[0m21:29:52.835661 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:52.835832 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:29:52.835974 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:29:52.843588 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m21:29:52.844162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '890f4b10-c930-4e43-982d-89d5ac09d8bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e50bb50>]}
[0m21:29:52.844390 [debug] [MainThread]: On master: ROLLBACK
[0m21:29:52.844771 [debug] [MainThread]: On master: COMMIT
[0m21:29:52.844893 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:52.845005 [debug] [MainThread]: On master: COMMIT
[0m21:29:52.845586 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:29:52.845742 [debug] [MainThread]: On master: Close
[0m21:29:52.847293 [debug] [Thread-1 (]: Began running node model.airflow_agents_dbt.customer_summary
[0m21:29:52.847455 [debug] [Thread-2 (]: Began running node model.airflow_agents_dbt.run_events
[0m21:29:52.847668 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics.customer_summary ........................ [RUN]
[0m21:29:52.847881 [info ] [Thread-2 (]: 2 of 2 START sql incremental model analytics.run_events ........................ [RUN]
[0m21:29:52.848071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_analytics, now model.airflow_agents_dbt.customer_summary)
[0m21:29:52.848271 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_agents_dbt.run_events'
[0m21:29:52.848424 [debug] [Thread-1 (]: Began compiling node model.airflow_agents_dbt.customer_summary
[0m21:29:52.848562 [debug] [Thread-2 (]: Began compiling node model.airflow_agents_dbt.run_events
[0m21:29:52.852029 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_agents_dbt.customer_summary"
[0m21:29:52.879342 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_agents_dbt.run_events"
[0m21:29:52.879719 [debug] [Thread-1 (]: Began executing node model.airflow_agents_dbt.customer_summary
[0m21:29:52.879862 [debug] [Thread-2 (]: Began executing node model.airflow_agents_dbt.run_events
[0m21:29:52.894126 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_agents_dbt.customer_summary"
[0m21:29:52.906119 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_agents_dbt.run_events"
[0m21:29:52.906706 [debug] [Thread-1 (]: Using postgres connection "model.airflow_agents_dbt.customer_summary"
[0m21:29:52.906916 [debug] [Thread-2 (]: Using postgres connection "model.airflow_agents_dbt.run_events"
[0m21:29:52.907068 [debug] [Thread-1 (]: On model.airflow_agents_dbt.customer_summary: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "node_id": "model.airflow_agents_dbt.customer_summary"} */

  
    

  create  table "dbt"."analytics"."customer_summary__dbt_tmp"
  
  
    as
  
  (
    select
  customer_id,
  first_name,
  last_name,
  is_active::boolean as is_active
from "dbt"."analytics"."raw_customers"
  );
  
[0m21:29:52.907203 [debug] [Thread-2 (]: On model.airflow_agents_dbt.run_events: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "node_id": "model.airflow_agents_dbt.run_events"} */

      
  
    

  create  table "dbt"."analytics"."run_events"
  
  
    as
  
  (
    

select
  '2026-02-08 00:29:52.484560+00:00'::timestamp as run_started_at,
  '890f4b10-c930-4e43-982d-89d5ac09d8bc' as invocation_id
  );
  
  
[0m21:29:52.907327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:52.907465 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:29:52.920880 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "analytics.raw_customers" does not exist
LINE 17: from "dbt"."analytics"."raw_customers"
              ^

[0m21:29:52.921039 [debug] [Thread-1 (]: On model.airflow_agents_dbt.customer_summary: ROLLBACK
[0m21:29:52.921992 [debug] [Thread-1 (]: On model.airflow_agents_dbt.customer_summary: Close
[0m21:29:52.924373 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.017 seconds
[0m21:29:52.931180 [debug] [Thread-2 (]: On model.airflow_agents_dbt.run_events: COMMIT
[0m21:29:52.931390 [debug] [Thread-2 (]: Using postgres connection "model.airflow_agents_dbt.run_events"
[0m21:29:52.931540 [debug] [Thread-2 (]: On model.airflow_agents_dbt.run_events: COMMIT
[0m21:29:52.932380 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m21:29:52.933166 [debug] [Thread-2 (]: On model.airflow_agents_dbt.run_events: Close
[0m21:29:52.934675 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '890f4b10-c930-4e43-982d-89d5ac09d8bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8a1110>]}
[0m21:29:52.935452 [debug] [Thread-1 (]: Database Error in model customer_summary (models/customer_summary.sql)
  relation "analytics.raw_customers" does not exist
  LINE 17: from "dbt"."analytics"."raw_customers"
                ^
  compiled code at target/run/airflow_agents_dbt/models/customer_summary.sql
[0m21:29:52.935762 [info ] [Thread-2 (]: 2 of 2 OK created sql incremental model analytics.run_events ................... [[32mSELECT 1[0m in 0.09s]
[0m21:29:52.935978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '890f4b10-c930-4e43-982d-89d5ac09d8bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e853550>]}
[0m21:29:52.936224 [debug] [Thread-2 (]: Finished running node model.airflow_agents_dbt.run_events
[0m21:29:52.936459 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model analytics.customer_summary ............... [[31mERROR[0m in 0.09s]
[0m21:29:52.936747 [debug] [Thread-1 (]: Finished running node model.airflow_agents_dbt.customer_summary
[0m21:29:52.936948 [debug] [Thread-7 (]: Marking all children of 'model.airflow_agents_dbt.customer_summary' to be skipped because of status 'error'.  Reason: Database Error in model customer_summary (models/customer_summary.sql)
  relation "analytics.raw_customers" does not exist
  LINE 17: from "dbt"."analytics"."raw_customers"
                ^
  compiled code at target/run/airflow_agents_dbt/models/customer_summary.sql.
[0m21:29:52.937729 [debug] [MainThread]: On master: COMMIT
[0m21:29:52.937862 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:52.937972 [debug] [MainThread]: On master: COMMIT
[0m21:29:52.938065 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:29:52.945170 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m21:29:52.945385 [debug] [MainThread]: On master: Close
[0m21:29:52.945557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:52.945680 [debug] [MainThread]: Connection 'model.airflow_agents_dbt.customer_summary' was properly closed.
[0m21:29:52.945780 [debug] [MainThread]: Connection 'model.airflow_agents_dbt.run_events' was properly closed.
[0m21:29:52.945904 [info ] [MainThread]: 
[0m21:29:52.946036 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m21:29:52.946369 [debug] [MainThread]: Command end result
[0m21:29:52.954859 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/manifest.json
[0m21:29:52.955608 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/semantic_manifest.json
[0m21:29:52.957891 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/run_results.json
[0m21:29:52.958024 [info ] [MainThread]: 
[0m21:29:52.958252 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:29:52.958440 [info ] [MainThread]: 
[0m21:29:52.958598 [error] [MainThread]: [31mFailure in model customer_summary (models/customer_summary.sql)[0m
[0m21:29:52.958737 [error] [MainThread]:   Database Error in model customer_summary (models/customer_summary.sql)
  relation "analytics.raw_customers" does not exist
  LINE 17: from "dbt"."analytics"."raw_customers"
                ^
  compiled code at target/run/airflow_agents_dbt/models/customer_summary.sql
[0m21:29:52.958848 [info ] [MainThread]: 
[0m21:29:52.958996 [info ] [MainThread]:   compiled code at target/compiled/airflow_agents_dbt/models/customer_summary.sql
[0m21:29:52.959120 [info ] [MainThread]: 
[0m21:29:52.959254 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m21:29:52.961392 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.50207186, "process_in_blocks": "0", "process_kernel_time": 0.178321, "process_mem_max_rss": "142180352", "process_out_blocks": "0", "process_user_time": 1.001301}
[0m21:29:52.961655 [debug] [MainThread]: Command `dbt run` failed at 21:29:52.961615 after 0.50 seconds
[0m21:29:52.961838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109304590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d393b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d393990>]}
[0m21:29:52.961988 [debug] [MainThread]: Flushing usage events
[0m21:29:53.746011 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:30:20.223586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a3c1ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a586a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99baa720>]}


============================== 00:30:20.242688 | f481d2dd-8c3e-4a50-972f-062898acf376 ==============================
[0m00:30:20.242688 [info ] [MainThread]: Running with dbt=1.11.3
[0m00:30:20.243099 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/include/dbt', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'empty': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'version_check': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'no_print': 'None', 'warn_error': 'None', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'log_format': 'default', 'log_path': '/usr/local/airflow/include/dbt/logs', 'introspect': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt seed'}
[0m00:30:20.312760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f481d2dd-8c3e-4a50-972f-062898acf376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff994d5670>]}
[0m00:30:20.334545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f481d2dd-8c3e-4a50-972f-062898acf376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff994d4260>]}
[0m00:30:20.334957 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m00:30:20.363322 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m00:30:20.399932 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:30:20.400290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f481d2dd-8c3e-4a50-972f-062898acf376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99cd99d0>]}
[0m00:30:20.833126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f481d2dd-8c3e-4a50-972f-062898acf376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98408980>]}
[0m00:30:20.863252 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/include/dbt/target/manifest.json
[0m00:30:20.864206 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/include/dbt/target/semantic_manifest.json
[0m00:30:20.880781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f481d2dd-8c3e-4a50-972f-062898acf376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97faa030>]}
[0m00:30:20.881038 [info ] [MainThread]: Found 2 models, 1 seed, 1 test, 464 macros
[0m00:30:20.881377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f481d2dd-8c3e-4a50-972f-062898acf376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9836a540>]}
[0m00:30:20.882199 [info ] [MainThread]: 
[0m00:30:20.882462 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:30:20.882577 [info ] [MainThread]: 
[0m00:30:20.882860 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:30:20.883270 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:30:20.898723 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:30:20.898916 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:30:20.899095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:30:20.904172 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "dbt-postgres" to address: Name or service not known

[0m00:30:20.906676 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:30:20.906863 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:30:20.907038 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m00:30:20.907154 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:30:20.907273 [debug] [ThreadPool]: On list_dbt: No close available on handle
[0m00:30:20.907555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:30:20.907702 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m00:30:20.907832 [info ] [MainThread]: 
[0m00:30:20.908005 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m00:30:20.908245 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "dbt-postgres" to address: Name or service not known
  
[0m00:30:20.908750 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.7051687, "process_in_blocks": "0", "process_kernel_time": 0.134623, "process_mem_max_rss": "127228", "process_out_blocks": "1781", "process_user_time": 1.569615}
[0m00:30:20.908932 [debug] [MainThread]: Command `dbt seed` failed at 00:30:20.908896 after 0.71 seconds
[0m00:30:20.909074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a3c8ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f24440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97f84320>]}
[0m00:30:20.909223 [debug] [MainThread]: Flushing usage events
[0m00:30:21.869206 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:32:37.342821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b553f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e253f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e253fd0>]}


============================== 21:32:37.346018 | 593a2901-995f-4ec2-8b94-3de63c561d60 ==============================
[0m21:32:37.346018 [info ] [MainThread]: Running with dbt=1.11.3
[0m21:32:37.346319 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'log_path': '/Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/logs', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'use_colors': 'True', 'indirect_selection': 'eager', 'empty': 'None', 'quiet': 'False', 'invocation_command': 'dbt seed', 'fail_fast': 'False', 'debug': 'False', 'introspect': 'True', 'target_path': 'None', 'printer_width': '80', 'static_parser': 'True', 'use_experimental_parser': 'False'}
[0m21:32:37.443676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '593a2901-995f-4ec2-8b94-3de63c561d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2a2310>]}
[0m21:32:37.468295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '593a2901-995f-4ec2-8b94-3de63c561d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5921d0>]}
[0m21:32:37.469521 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:32:37.522196 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m21:32:37.566252 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:32:37.566543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '593a2901-995f-4ec2-8b94-3de63c561d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3bff50>]}
[0m21:32:38.037139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '593a2901-995f-4ec2-8b94-3de63c561d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3d4650>]}
[0m21:32:38.067611 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/manifest.json
[0m21:32:38.068640 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/semantic_manifest.json
[0m21:32:38.079453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '593a2901-995f-4ec2-8b94-3de63c561d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f70e2d0>]}
[0m21:32:38.079673 [info ] [MainThread]: Found 2 models, 1 seed, 1 test, 464 macros
[0m21:32:38.079815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '593a2901-995f-4ec2-8b94-3de63c561d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f617090>]}
[0m21:32:38.080491 [info ] [MainThread]: 
[0m21:32:38.080635 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:32:38.080748 [info ] [MainThread]: 
[0m21:32:38.080950 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:32:38.081326 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m21:32:38.105985 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m21:32:38.106181 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m21:32:38.106288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:38.153181 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.047 seconds
[0m21:32:38.153898 [debug] [ThreadPool]: On list_dbt: Close
[0m21:32:38.155762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_analytics)
[0m21:32:38.157990 [debug] [ThreadPool]: Using postgres connection "list_dbt_analytics"
[0m21:32:38.158135 [debug] [ThreadPool]: On list_dbt_analytics: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "list_dbt_analytics"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:32:38.158263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:32:38.170069 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m21:32:38.170740 [debug] [ThreadPool]: On list_dbt_analytics: ROLLBACK
[0m21:32:38.171229 [debug] [ThreadPool]: On list_dbt_analytics: Close
[0m21:32:38.173285 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:38.173463 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:32:38.173613 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:32:38.181732 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m21:32:38.182258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '593a2901-995f-4ec2-8b94-3de63c561d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0db5d0>]}
[0m21:32:38.182479 [debug] [MainThread]: On master: ROLLBACK
[0m21:32:38.182888 [debug] [MainThread]: On master: COMMIT
[0m21:32:38.183012 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:38.183114 [debug] [MainThread]: On master: COMMIT
[0m21:32:38.183692 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:32:38.183805 [debug] [MainThread]: On master: Close
[0m21:32:38.185341 [debug] [Thread-1 (]: Began running node seed.airflow_agents_dbt.raw_customers
[0m21:32:38.185613 [info ] [Thread-1 (]: 1 of 1 START seed file analytics.raw_customers ................................. [RUN]
[0m21:32:38.185841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_analytics, now seed.airflow_agents_dbt.raw_customers)
[0m21:32:38.185986 [debug] [Thread-1 (]: Began compiling node seed.airflow_agents_dbt.raw_customers
[0m21:32:38.186131 [debug] [Thread-1 (]: Began executing node seed.airflow_agents_dbt.raw_customers
[0m21:32:38.196754 [debug] [Thread-1 (]: Using postgres connection "seed.airflow_agents_dbt.raw_customers"
[0m21:32:38.197016 [debug] [Thread-1 (]: On seed.airflow_agents_dbt.raw_customers: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "node_id": "seed.airflow_agents_dbt.raw_customers"} */

    create table "dbt"."analytics"."raw_customers" ("customer_id" integer,"first_name" text,"last_name" text,"is_active" boolean)
  
[0m21:32:38.197200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:38.207402 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.010 seconds
[0m21:32:38.213871 [debug] [Thread-1 (]: Using postgres connection "seed.airflow_agents_dbt.raw_customers"
[0m21:32:38.214039 [debug] [Thread-1 (]: On seed.airflow_agents_dbt.raw_customers: 
          insert into "dbt"."analytics"."raw_customers" ("customer_id", "first_name", "last_name", "is_active") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m21:32:38.214692 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m21:32:38.216788 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.airflow_agents_dbt.raw_customers"
[0m21:32:38.223683 [debug] [Thread-1 (]: On seed.airflow_agents_dbt.raw_customers: COMMIT
[0m21:32:38.223901 [debug] [Thread-1 (]: Using postgres connection "seed.airflow_agents_dbt.raw_customers"
[0m21:32:38.224026 [debug] [Thread-1 (]: On seed.airflow_agents_dbt.raw_customers: COMMIT
[0m21:32:38.224892 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:32:38.225574 [debug] [Thread-1 (]: On seed.airflow_agents_dbt.raw_customers: Close
[0m21:32:38.226423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '593a2901-995f-4ec2-8b94-3de63c561d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f51e910>]}
[0m21:32:38.226654 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file analytics.raw_customers ............................. [[32mINSERT 3[0m in 0.04s]
[0m21:32:38.226901 [debug] [Thread-1 (]: Finished running node seed.airflow_agents_dbt.raw_customers
[0m21:32:38.227412 [debug] [MainThread]: On master: COMMIT
[0m21:32:38.227555 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:38.227662 [debug] [MainThread]: On master: COMMIT
[0m21:32:38.227770 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:32:38.233799 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m21:32:38.233979 [debug] [MainThread]: On master: Close
[0m21:32:38.234149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:32:38.234270 [debug] [MainThread]: Connection 'seed.airflow_agents_dbt.raw_customers' was properly closed.
[0m21:32:38.234391 [info ] [MainThread]: 
[0m21:32:38.234514 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m21:32:38.234780 [debug] [MainThread]: Command end result
[0m21:32:38.273337 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/manifest.json
[0m21:32:38.274125 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/semantic_manifest.json
[0m21:32:38.276361 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/run_results.json
[0m21:32:38.276480 [info ] [MainThread]: 
[0m21:32:38.276646 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:32:38.276761 [info ] [MainThread]: 
[0m21:32:38.276888 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:32:38.278640 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.98869896, "process_in_blocks": "0", "process_kernel_time": 0.227413, "process_mem_max_rss": "149438464", "process_out_blocks": "0", "process_user_time": 1.425894}
[0m21:32:38.278800 [debug] [MainThread]: Command `dbt seed` succeeded at 21:32:38.278768 after 0.99 seconds
[0m21:32:38.278936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e7d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051ec690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051ecb90>]}
[0m21:32:38.279061 [debug] [MainThread]: Flushing usage events
[0m21:32:39.307324 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:32:45.239021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b036cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da3ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd13e10>]}


============================== 21:32:45.241499 | a80efe31-5946-4d21-9f1e-1f8dbe38d3ac ==============================
[0m21:32:45.241499 [info ] [MainThread]: Running with dbt=1.11.3
[0m21:32:45.241756 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'printer_width': '80', 'static_parser': 'True', 'quiet': 'False', 'partial_parse': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'introspect': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'warn_error': 'None', 'target_path': 'None', 'use_colors': 'True', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/logs', 'profiles_dir': '/Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m21:32:45.308836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a80efe31-5946-4d21-9f1e-1f8dbe38d3ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b241210>]}
[0m21:32:45.332473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a80efe31-5946-4d21-9f1e-1f8dbe38d3ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0522d0>]}
[0m21:32:45.333276 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:32:45.385610 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m21:32:45.442477 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:32:45.442685 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:32:45.442798 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:32:45.461731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a80efe31-5946-4d21-9f1e-1f8dbe38d3ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd10490>]}
[0m21:32:45.492426 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/manifest.json
[0m21:32:45.493357 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/semantic_manifest.json
[0m21:32:45.502188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a80efe31-5946-4d21-9f1e-1f8dbe38d3ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edb5990>]}
[0m21:32:45.502426 [info ] [MainThread]: Found 2 models, 1 seed, 1 test, 464 macros
[0m21:32:45.502570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a80efe31-5946-4d21-9f1e-1f8dbe38d3ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb9a750>]}
[0m21:32:45.503293 [info ] [MainThread]: 
[0m21:32:45.503442 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:32:45.503554 [info ] [MainThread]: 
[0m21:32:45.503764 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:32:45.505284 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m21:32:45.530131 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m21:32:45.530323 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m21:32:45.530433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:45.560848 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.030 seconds
[0m21:32:45.561469 [debug] [ThreadPool]: On list_dbt: Close
[0m21:32:45.562154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_analytics)
[0m21:32:45.564727 [debug] [ThreadPool]: Using postgres connection "list_dbt_analytics"
[0m21:32:45.564896 [debug] [ThreadPool]: On list_dbt_analytics: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "list_dbt_analytics"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:32:45.565018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:32:45.576877 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.012 seconds
[0m21:32:45.577508 [debug] [ThreadPool]: On list_dbt_analytics: ROLLBACK
[0m21:32:45.578024 [debug] [ThreadPool]: On list_dbt_analytics: Close
[0m21:32:45.580192 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:45.580382 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:32:45.580538 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:32:45.590946 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m21:32:45.591485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a80efe31-5946-4d21-9f1e-1f8dbe38d3ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edc3310>]}
[0m21:32:45.591697 [debug] [MainThread]: On master: ROLLBACK
[0m21:32:45.592099 [debug] [MainThread]: On master: COMMIT
[0m21:32:45.592218 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:45.592330 [debug] [MainThread]: On master: COMMIT
[0m21:32:45.592937 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:32:45.593074 [debug] [MainThread]: On master: Close
[0m21:32:45.594997 [debug] [Thread-1 (]: Began running node model.airflow_agents_dbt.customer_summary
[0m21:32:45.595152 [debug] [Thread-2 (]: Began running node model.airflow_agents_dbt.run_events
[0m21:32:45.595378 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics.customer_summary ........................ [RUN]
[0m21:32:45.595597 [info ] [Thread-2 (]: 2 of 2 START sql incremental model analytics.run_events ........................ [RUN]
[0m21:32:45.595790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_analytics, now model.airflow_agents_dbt.customer_summary)
[0m21:32:45.596073 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_agents_dbt.run_events'
[0m21:32:45.596217 [debug] [Thread-1 (]: Began compiling node model.airflow_agents_dbt.customer_summary
[0m21:32:45.596348 [debug] [Thread-2 (]: Began compiling node model.airflow_agents_dbt.run_events
[0m21:32:45.599286 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_agents_dbt.customer_summary"
[0m21:32:45.600818 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_agents_dbt.run_events"
[0m21:32:45.601173 [debug] [Thread-1 (]: Began executing node model.airflow_agents_dbt.customer_summary
[0m21:32:45.601321 [debug] [Thread-2 (]: Began executing node model.airflow_agents_dbt.run_events
[0m21:32:45.641716 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_agents_dbt.customer_summary"
[0m21:32:45.653433 [debug] [Thread-2 (]: Using postgres connection "model.airflow_agents_dbt.run_events"
[0m21:32:45.653681 [debug] [Thread-2 (]: On model.airflow_agents_dbt.run_events: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "node_id": "model.airflow_agents_dbt.run_events"} */

    
  
    

  create temporary table "run_events__dbt_tmp213245650672"
  
  
    as
  
  (
    

select
  '2026-02-08 00:32:45.229711+00:00'::timestamp as run_started_at,
  'a80efe31-5946-4d21-9f1e-1f8dbe38d3ac' as invocation_id
  );
  
  
[0m21:32:45.653819 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:32:45.654098 [debug] [Thread-1 (]: Using postgres connection "model.airflow_agents_dbt.customer_summary"
[0m21:32:45.654258 [debug] [Thread-1 (]: On model.airflow_agents_dbt.customer_summary: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "node_id": "model.airflow_agents_dbt.customer_summary"} */

  
    

  create  table "dbt"."analytics"."customer_summary__dbt_tmp"
  
  
    as
  
  (
    select
  customer_id,
  first_name,
  last_name,
  is_active::boolean as is_active
from "dbt"."analytics"."raw_customers"
  );
  
[0m21:32:45.654395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:45.672049 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.018 seconds
[0m21:32:45.677334 [debug] [Thread-2 (]: Using postgres connection "model.airflow_agents_dbt.run_events"
[0m21:32:45.677503 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.023 seconds
[0m21:32:45.677641 [debug] [Thread-2 (]: On model.airflow_agents_dbt.run_events: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "node_id": "model.airflow_agents_dbt.run_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'run_events__dbt_tmp213245650672'
        
      order by ordinal_position

  
[0m21:32:45.680865 [debug] [Thread-1 (]: Using postgres connection "model.airflow_agents_dbt.customer_summary"
[0m21:32:45.681044 [debug] [Thread-1 (]: On model.airflow_agents_dbt.customer_summary: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "node_id": "model.airflow_agents_dbt.customer_summary"} */
alter table "dbt"."analytics"."customer_summary__dbt_tmp" rename to "customer_summary"
[0m21:32:45.683798 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m21:32:45.689089 [debug] [Thread-1 (]: On model.airflow_agents_dbt.customer_summary: COMMIT
[0m21:32:45.689299 [debug] [Thread-1 (]: Using postgres connection "model.airflow_agents_dbt.customer_summary"
[0m21:32:45.689459 [debug] [Thread-1 (]: On model.airflow_agents_dbt.customer_summary: COMMIT
[0m21:32:45.690047 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.009 seconds
[0m21:32:45.692124 [debug] [Thread-2 (]: Using postgres connection "model.airflow_agents_dbt.run_events"
[0m21:32:45.692268 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m21:32:45.692407 [debug] [Thread-2 (]: On model.airflow_agents_dbt.run_events: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "node_id": "model.airflow_agents_dbt.run_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'run_events'
        
        and table_schema = 'analytics'
        
      order by ordinal_position

  
[0m21:32:45.694514 [debug] [Thread-1 (]: Applying DROP to: "dbt"."analytics"."customer_summary__dbt_backup"
[0m21:32:45.696430 [debug] [Thread-1 (]: Using postgres connection "model.airflow_agents_dbt.customer_summary"
[0m21:32:45.696596 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.002 seconds
[0m21:32:45.696746 [debug] [Thread-1 (]: On model.airflow_agents_dbt.customer_summary: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "node_id": "model.airflow_agents_dbt.customer_summary"} */
drop table if exists "dbt"."analytics"."customer_summary__dbt_backup" cascade
[0m21:32:45.700601 [debug] [Thread-2 (]: Using postgres connection "model.airflow_agents_dbt.run_events"
[0m21:32:45.700806 [debug] [Thread-2 (]: On model.airflow_agents_dbt.run_events: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "node_id": "model.airflow_agents_dbt.run_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'run_events'
        
        and table_schema = 'analytics'
        
      order by ordinal_position

  
[0m21:32:45.701264 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m21:32:45.702324 [debug] [Thread-1 (]: On model.airflow_agents_dbt.customer_summary: Close
[0m21:32:45.702457 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.001 seconds
[0m21:32:45.707270 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_agents_dbt.run_events"
[0m21:32:45.708004 [debug] [Thread-2 (]: Using postgres connection "model.airflow_agents_dbt.run_events"
[0m21:32:45.708141 [debug] [Thread-2 (]: On model.airflow_agents_dbt.run_events: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "node_id": "model.airflow_agents_dbt.run_events"} */

      insert into "dbt"."analytics"."run_events" ("run_started_at", "invocation_id")
    (
        select "run_started_at", "invocation_id"
        from "run_events__dbt_tmp213245650672"
    )


  
[0m21:32:45.709603 [debug] [Thread-2 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m21:32:45.710130 [debug] [Thread-2 (]: On model.airflow_agents_dbt.run_events: COMMIT
[0m21:32:45.710285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a80efe31-5946-4d21-9f1e-1f8dbe38d3ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f232e50>]}
[0m21:32:45.710409 [debug] [Thread-2 (]: Using postgres connection "model.airflow_agents_dbt.run_events"
[0m21:32:45.710659 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics.customer_summary ................... [[32mSELECT 3[0m in 0.11s]
[0m21:32:45.710830 [debug] [Thread-2 (]: On model.airflow_agents_dbt.run_events: COMMIT
[0m21:32:45.711062 [debug] [Thread-1 (]: Finished running node model.airflow_agents_dbt.customer_summary
[0m21:32:45.712472 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m21:32:45.712744 [debug] [Thread-2 (]: On model.airflow_agents_dbt.run_events: Close
[0m21:32:45.712921 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a80efe31-5946-4d21-9f1e-1f8dbe38d3ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee4b750>]}
[0m21:32:45.713109 [info ] [Thread-2 (]: 2 of 2 OK created sql incremental model analytics.run_events ................... [[32mINSERT 0 1[0m in 0.12s]
[0m21:32:45.713307 [debug] [Thread-2 (]: Finished running node model.airflow_agents_dbt.run_events
[0m21:32:45.713785 [debug] [MainThread]: On master: COMMIT
[0m21:32:45.713911 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:45.714018 [debug] [MainThread]: On master: COMMIT
[0m21:32:45.714120 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:32:45.720049 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m21:32:45.720281 [debug] [MainThread]: On master: Close
[0m21:32:45.720596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:32:45.720786 [debug] [MainThread]: Connection 'model.airflow_agents_dbt.customer_summary' was properly closed.
[0m21:32:45.720897 [debug] [MainThread]: Connection 'model.airflow_agents_dbt.run_events' was properly closed.
[0m21:32:45.721033 [info ] [MainThread]: 
[0m21:32:45.721209 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m21:32:45.721565 [debug] [MainThread]: Command end result
[0m21:32:45.729636 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/manifest.json
[0m21:32:45.730371 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/semantic_manifest.json
[0m21:32:45.732687 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ale/git/personal/airflow_agents_skills/airflow/include/dbt/target/run_results.json
[0m21:32:45.732799 [info ] [MainThread]: 
[0m21:32:45.732968 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:32:45.733087 [info ] [MainThread]: 
[0m21:32:45.733212 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m21:32:45.734726 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5256734, "process_in_blocks": "0", "process_kernel_time": 0.191621, "process_mem_max_rss": "140607488", "process_out_blocks": "0", "process_user_time": 1.009174}
[0m21:32:45.734892 [debug] [MainThread]: Command `dbt run` succeeded at 21:32:45.734863 after 0.53 seconds
[0m21:32:45.735027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105067d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10506c690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10506cb90>]}
[0m21:32:45.735167 [debug] [MainThread]: Flushing usage events
[0m21:32:46.527066 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:33:14.958186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4d3e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4d3d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4d3d160>]}


============================== 00:33:14.979919 | 57f77d4f-12ec-4bc1-83fb-b2cd2740944b ==============================
[0m00:33:14.979919 [info ] [MainThread]: Running with dbt=1.11.3
[0m00:33:14.980389 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'write_json': 'True', 'invocation_command': 'dbt seed', 'use_experimental_parser': 'False', 'static_parser': 'True', 'no_print': 'None', 'quiet': 'False', 'use_colors': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'empty': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'introspect': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs'}
[0m00:33:15.052403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57f77d4f-12ec-4bc1-83fb-b2cd2740944b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb50cf860>]}
[0m00:33:15.074651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57f77d4f-12ec-4bc1-83fb-b2cd2740944b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6ab1310>]}
[0m00:33:15.075081 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m00:33:15.103631 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m00:33:15.141644 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:33:15.142074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '57f77d4f-12ec-4bc1-83fb-b2cd2740944b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3ca84d0>]}
[0m00:33:15.573507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57f77d4f-12ec-4bc1-83fb-b2cd2740944b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b1c5f0>]}
[0m00:33:15.604211 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/include/dbt/target/manifest.json
[0m00:33:15.605157 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/include/dbt/target/semantic_manifest.json
[0m00:33:15.621804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57f77d4f-12ec-4bc1-83fb-b2cd2740944b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2f49af0>]}
[0m00:33:15.622068 [info ] [MainThread]: Found 2 models, 1 seed, 1 test, 464 macros
[0m00:33:15.622406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57f77d4f-12ec-4bc1-83fb-b2cd2740944b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb30b7ef0>]}
[0m00:33:15.623132 [info ] [MainThread]: 
[0m00:33:15.623402 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:33:15.623638 [info ] [MainThread]: 
[0m00:33:15.623980 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:33:15.624447 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:33:15.640147 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:33:15.640343 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:33:15.640494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:15.645542 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "dbt-postgres" to address: Name or service not known

[0m00:33:15.648685 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:33:15.648819 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:33:15.648962 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m00:33:15.649089 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:33:15.649204 [debug] [ThreadPool]: On list_dbt: No close available on handle
[0m00:33:15.649464 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:33:15.649599 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m00:33:15.649719 [info ] [MainThread]: 
[0m00:33:15.649848 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m00:33:15.650052 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "dbt-postgres" to address: Name or service not known
  
[0m00:33:15.650527 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.7149574, "process_in_blocks": "0", "process_kernel_time": 0.14439, "process_mem_max_rss": "127084", "process_out_blocks": "1781", "process_user_time": 1.610349}
[0m00:33:15.650729 [debug] [MainThread]: Command `dbt seed` failed at 00:33:15.650694 after 0.72 seconds
[0m00:33:15.650884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4d46960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2f614c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2e6ea80>]}
[0m00:33:15.651049 [debug] [MainThread]: Flushing usage events
[0m00:33:16.632165 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:36:22.441758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80cc8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fe98bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff809c09b0>]}


============================== 00:36:22.459874 | 189c1d49-35ad-4a3d-9e83-b137a4b6b473 ==============================
[0m00:36:22.459874 [info ] [MainThread]: Running with dbt=1.11.3
[0m00:36:22.460306 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt seed', 'target_path': 'None', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'quiet': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'no_print': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'empty': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'printer_width': '80'}
[0m00:36:22.530109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '189c1d49-35ad-4a3d-9e83-b137a4b6b473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80bfe480>]}
[0m00:36:22.551602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '189c1d49-35ad-4a3d-9e83-b137a4b6b473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ffd6270>]}
[0m00:36:22.552028 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m00:36:22.583590 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m00:36:22.630489 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:36:22.630710 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m00:36:22.630873 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:36:22.647630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '189c1d49-35ad-4a3d-9e83-b137a4b6b473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f714e00>]}
[0m00:36:22.678772 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/include/dbt/target/manifest.json
[0m00:36:22.679703 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/include/dbt/target/semantic_manifest.json
[0m00:36:22.696889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '189c1d49-35ad-4a3d-9e83-b137a4b6b473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f3f9c40>]}
[0m00:36:22.697160 [info ] [MainThread]: Found 2 models, 1 seed, 1 test, 464 macros
[0m00:36:22.697444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '189c1d49-35ad-4a3d-9e83-b137a4b6b473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea8e480>]}
[0m00:36:22.698140 [info ] [MainThread]: 
[0m00:36:22.698395 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:36:22.698575 [info ] [MainThread]: 
[0m00:36:22.698848 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:36:22.699305 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:36:22.715886 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:36:22.716107 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:36:22.716254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:36:22.732199 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "dbt-postgres" to address: Name or service not known

[0m00:36:22.736704 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:36:22.736857 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:36:22.737005 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m00:36:22.737113 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:36:22.737231 [debug] [ThreadPool]: On list_dbt: No close available on handle
[0m00:36:22.737501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:36:22.737662 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m00:36:22.737785 [info ] [MainThread]: 
[0m00:36:22.737936 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m00:36:22.738142 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "dbt-postgres" to address: Name or service not known
  
[0m00:36:22.738628 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.3165831, "process_in_blocks": "0", "process_kernel_time": 0.12487, "process_mem_max_rss": "123424", "process_out_blocks": "896", "process_user_time": 1.210744}
[0m00:36:22.738876 [debug] [MainThread]: Command `dbt seed` failed at 00:36:22.738819 after 0.32 seconds
[0m00:36:22.739103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7feb05f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea9e630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea9f650>]}
[0m00:36:22.739316 [debug] [MainThread]: Flushing usage events
[0m00:36:23.916185 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:37:53.180954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf891820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0244980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0cfb950>]}


============================== 00:37:53.205175 | 2efe2b30-e26c-43ba-8ba5-e6a58693e538 ==============================
[0m00:37:53.205175 [info ] [MainThread]: Running with dbt=1.11.3
[0m00:37:53.205708 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'partial_parse': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'introspect': 'True', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'printer_width': '80', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'target_path': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt'}
[0m00:37:53.277026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2efe2b30-e26c-43ba-8ba5-e6a58693e538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf9ba780>]}
[0m00:37:53.299004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2efe2b30-e26c-43ba-8ba5-e6a58693e538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafc34e30>]}
[0m00:37:53.299401 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m00:37:53.328022 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m00:37:53.367007 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:37:53.367464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2efe2b30-e26c-43ba-8ba5-e6a58693e538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf8cd160>]}
[0m00:37:53.818272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2efe2b30-e26c-43ba-8ba5-e6a58693e538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaef08830>]}
[0m00:37:53.858171 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/include/dbt/target/manifest.json
[0m00:37:53.859286 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/include/dbt/target/semantic_manifest.json
[0m00:37:53.877466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2efe2b30-e26c-43ba-8ba5-e6a58693e538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad7a2450>]}
[0m00:37:53.877756 [info ] [MainThread]: Found 2 models, 1 seed, 1 test, 464 macros
[0m00:37:53.878159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2efe2b30-e26c-43ba-8ba5-e6a58693e538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadb98fb0>]}
[0m00:37:53.878923 [info ] [MainThread]: 
[0m00:37:53.879173 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:37:53.879359 [info ] [MainThread]: 
[0m00:37:53.879636 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:37:53.880094 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:37:53.896399 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:37:53.896624 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:37:53.896863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:37:53.914166 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.017 seconds
[0m00:37:53.914830 [debug] [ThreadPool]: On list_dbt: Close
[0m00:37:53.917498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_analytics)
[0m00:37:53.919848 [debug] [ThreadPool]: Using postgres connection "list_dbt_analytics"
[0m00:37:53.920031 [debug] [ThreadPool]: On list_dbt_analytics: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "list_dbt_analytics"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m00:37:53.920189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:37:53.928794 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.009 seconds
[0m00:37:53.929418 [debug] [ThreadPool]: On list_dbt_analytics: ROLLBACK
[0m00:37:53.929938 [debug] [ThreadPool]: On list_dbt_analytics: Close
[0m00:37:53.932472 [debug] [MainThread]: Using postgres connection "master"
[0m00:37:53.932754 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:37:53.933009 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:37:53.941452 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m00:37:53.942035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2efe2b30-e26c-43ba-8ba5-e6a58693e538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadb9aae0>]}
[0m00:37:53.942282 [debug] [MainThread]: On master: ROLLBACK
[0m00:37:53.942792 [debug] [MainThread]: On master: COMMIT
[0m00:37:53.942925 [debug] [MainThread]: Using postgres connection "master"
[0m00:37:53.943041 [debug] [MainThread]: On master: COMMIT
[0m00:37:53.943902 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:37:53.944058 [debug] [MainThread]: On master: Close
[0m00:37:53.945642 [debug] [Thread-1 (]: Began running node seed.airflow_agents_dbt.raw_customers
[0m00:37:53.946102 [info ] [Thread-1 (]: 1 of 1 START seed file analytics.raw_customers ................................. [RUN]
[0m00:37:53.946367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_analytics, now seed.airflow_agents_dbt.raw_customers)
[0m00:37:53.946610 [debug] [Thread-1 (]: Began compiling node seed.airflow_agents_dbt.raw_customers
[0m00:37:53.946823 [debug] [Thread-1 (]: Began executing node seed.airflow_agents_dbt.raw_customers
[0m00:37:53.959823 [debug] [Thread-1 (]: Using postgres connection "seed.airflow_agents_dbt.raw_customers"
[0m00:37:53.960029 [debug] [Thread-1 (]: On seed.airflow_agents_dbt.raw_customers: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "node_id": "seed.airflow_agents_dbt.raw_customers"} */
truncate table "dbt"."analytics"."raw_customers"
[0m00:37:53.960170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:37:53.967917 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.008 seconds
[0m00:37:53.974029 [debug] [Thread-1 (]: Using postgres connection "seed.airflow_agents_dbt.raw_customers"
[0m00:37:53.974221 [debug] [Thread-1 (]: On seed.airflow_agents_dbt.raw_customers: 
          insert into "dbt"."analytics"."raw_customers" ("customer_id", "first_name", "last_name", "is_active") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m00:37:53.974835 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.000 seconds
[0m00:37:53.976737 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.airflow_agents_dbt.raw_customers"
[0m00:37:53.982216 [debug] [Thread-1 (]: On seed.airflow_agents_dbt.raw_customers: COMMIT
[0m00:37:53.982393 [debug] [Thread-1 (]: Using postgres connection "seed.airflow_agents_dbt.raw_customers"
[0m00:37:53.982524 [debug] [Thread-1 (]: On seed.airflow_agents_dbt.raw_customers: COMMIT
[0m00:37:53.983765 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:37:53.984587 [debug] [Thread-1 (]: On seed.airflow_agents_dbt.raw_customers: Close
[0m00:37:53.985349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2efe2b30-e26c-43ba-8ba5-e6a58693e538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacb89b20>]}
[0m00:37:53.985619 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file analytics.raw_customers ............................. [[32mINSERT 3[0m in 0.04s]
[0m00:37:53.985900 [debug] [Thread-1 (]: Finished running node seed.airflow_agents_dbt.raw_customers
[0m00:37:53.986897 [debug] [MainThread]: On master: COMMIT
[0m00:37:53.987088 [debug] [MainThread]: Using postgres connection "master"
[0m00:37:53.987212 [debug] [MainThread]: On master: COMMIT
[0m00:37:53.987327 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:37:53.993712 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m00:37:53.993883 [debug] [MainThread]: On master: Close
[0m00:37:53.994101 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:37:53.994202 [debug] [MainThread]: Connection 'seed.airflow_agents_dbt.raw_customers' was properly closed.
[0m00:37:53.994363 [info ] [MainThread]: 
[0m00:37:53.994500 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m00:37:53.995014 [debug] [MainThread]: Command end result
[0m00:37:54.005443 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/include/dbt/target/manifest.json
[0m00:37:54.006327 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/include/dbt/target/semantic_manifest.json
[0m00:37:54.008520 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/include/dbt/target/run_results.json
[0m00:37:54.008641 [info ] [MainThread]: 
[0m00:37:54.008830 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:37:54.008983 [info ] [MainThread]: 
[0m00:37:54.009126 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:37:54.009583 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.8485551, "process_in_blocks": "0", "process_kernel_time": 0.128204, "process_mem_max_rss": "130672", "process_out_blocks": "2678", "process_user_time": 1.708728}
[0m00:37:54.009814 [debug] [MainThread]: Command `dbt seed` succeeded at 00:37:54.009766 after 0.85 seconds
[0m00:37:54.010025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf5d4470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf61eff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf015340>]}
[0m00:37:54.010289 [debug] [MainThread]: Flushing usage events
[0m00:37:55.192471 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:37:56.918089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa911e6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8fa5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8f9cd40>]}


============================== 00:37:56.938010 | fa8d0186-a357-4738-a29b-eff7c0c86aad ==============================
[0m00:37:56.938010 [info ] [MainThread]: Running with dbt=1.11.3
[0m00:37:56.938353 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'quiet': 'False', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'warn_error': 'None', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'use_colors': 'True', 'log_format': 'default', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'target_path': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'empty': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:37:57.003699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa8d0186-a357-4738-a29b-eff7c0c86aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa85e1bb0>]}
[0m00:37:57.025755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa8d0186-a357-4738-a29b-eff7c0c86aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa870d4c0>]}
[0m00:37:57.026247 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m00:37:57.053853 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m00:37:57.096649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:37:57.096855 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m00:37:57.096984 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:37:57.114059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa8d0186-a357-4738-a29b-eff7c0c86aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8556690>]}
[0m00:37:57.143728 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/include/dbt/target/manifest.json
[0m00:37:57.144593 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/include/dbt/target/semantic_manifest.json
[0m00:37:57.160242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa8d0186-a357-4738-a29b-eff7c0c86aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa83fad80>]}
[0m00:37:57.160467 [info ] [MainThread]: Found 2 models, 1 seed, 1 test, 464 macros
[0m00:37:57.160633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa8d0186-a357-4738-a29b-eff7c0c86aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8a092b0>]}
[0m00:37:57.161345 [info ] [MainThread]: 
[0m00:37:57.161533 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:37:57.161679 [info ] [MainThread]: 
[0m00:37:57.161916 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:37:57.163441 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:37:57.178270 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:37:57.178468 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:37:57.178606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:37:57.185596 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m00:37:57.186330 [debug] [ThreadPool]: On list_dbt: Close
[0m00:37:57.187320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_analytics)
[0m00:37:57.190242 [debug] [ThreadPool]: Using postgres connection "list_dbt_analytics"
[0m00:37:57.190454 [debug] [ThreadPool]: On list_dbt_analytics: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "list_dbt_analytics"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m00:37:57.190693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:37:57.197492 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m00:37:57.198171 [debug] [ThreadPool]: On list_dbt_analytics: ROLLBACK
[0m00:37:57.198679 [debug] [ThreadPool]: On list_dbt_analytics: Close
[0m00:37:57.200977 [debug] [MainThread]: Using postgres connection "master"
[0m00:37:57.201193 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:37:57.201369 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:37:57.208415 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m00:37:57.208975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa8d0186-a357-4738-a29b-eff7c0c86aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa785b9e0>]}
[0m00:37:57.209213 [debug] [MainThread]: On master: ROLLBACK
[0m00:37:57.209722 [debug] [MainThread]: On master: COMMIT
[0m00:37:57.209907 [debug] [MainThread]: Using postgres connection "master"
[0m00:37:57.210061 [debug] [MainThread]: On master: COMMIT
[0m00:37:57.210834 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:37:57.210967 [debug] [MainThread]: On master: Close
[0m00:37:57.212413 [debug] [Thread-1 (]: Began running node model.airflow_agents_dbt.customer_summary
[0m00:37:57.212601 [debug] [Thread-2 (]: Began running node model.airflow_agents_dbt.run_events
[0m00:37:57.212835 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics.customer_summary ........................ [RUN]
[0m00:37:57.213105 [info ] [Thread-2 (]: 2 of 2 START sql incremental model analytics.run_events ........................ [RUN]
[0m00:37:57.213348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_analytics, now model.airflow_agents_dbt.customer_summary)
[0m00:37:57.213635 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_agents_dbt.run_events'
[0m00:37:57.213952 [debug] [Thread-1 (]: Began compiling node model.airflow_agents_dbt.customer_summary
[0m00:37:57.214148 [debug] [Thread-2 (]: Began compiling node model.airflow_agents_dbt.run_events
[0m00:37:57.217047 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_agents_dbt.customer_summary"
[0m00:37:57.218173 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_agents_dbt.run_events"
[0m00:37:57.219110 [debug] [Thread-1 (]: Began executing node model.airflow_agents_dbt.customer_summary
[0m00:37:57.225421 [debug] [Thread-2 (]: Began executing node model.airflow_agents_dbt.run_events
[0m00:37:57.233448 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_agents_dbt.customer_summary"
[0m00:37:57.245136 [debug] [Thread-2 (]: Using postgres connection "model.airflow_agents_dbt.run_events"
[0m00:37:57.245409 [debug] [Thread-2 (]: On model.airflow_agents_dbt.run_events: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "node_id": "model.airflow_agents_dbt.run_events"} */

    
  
    

  create temporary table "run_events__dbt_tmp003757242585"
  
  
    as
  
  (
    

select
  '2026-02-08 00:37:56.917407+00:00'::timestamp as run_started_at,
  'fa8d0186-a357-4738-a29b-eff7c0c86aad' as invocation_id
  );
  
  
[0m00:37:57.245598 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:37:57.246296 [debug] [Thread-1 (]: Using postgres connection "model.airflow_agents_dbt.customer_summary"
[0m00:37:57.246553 [debug] [Thread-1 (]: On model.airflow_agents_dbt.customer_summary: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "node_id": "model.airflow_agents_dbt.customer_summary"} */

  
    

  create  table "dbt"."analytics"."customer_summary__dbt_tmp"
  
  
    as
  
  (
    select
  customer_id,
  first_name,
  last_name,
  is_active::boolean as is_active
from "dbt"."analytics"."raw_customers"
  );
  
[0m00:37:57.246779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:37:57.253808 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.008 seconds
[0m00:37:57.260521 [debug] [Thread-2 (]: Using postgres connection "model.airflow_agents_dbt.run_events"
[0m00:37:57.260869 [debug] [Thread-2 (]: On model.airflow_agents_dbt.run_events: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "node_id": "model.airflow_agents_dbt.run_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'run_events__dbt_tmp003757242585'
        
      order by ordinal_position

  
[0m00:37:57.260730 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.014 seconds
[0m00:37:57.264634 [debug] [Thread-1 (]: Using postgres connection "model.airflow_agents_dbt.customer_summary"
[0m00:37:57.264851 [debug] [Thread-1 (]: On model.airflow_agents_dbt.customer_summary: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "node_id": "model.airflow_agents_dbt.customer_summary"} */
alter table "dbt"."analytics"."customer_summary" rename to "customer_summary__dbt_backup"
[0m00:37:57.265494 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:37:57.267087 [debug] [Thread-1 (]: Using postgres connection "model.airflow_agents_dbt.customer_summary"
[0m00:37:57.267308 [debug] [Thread-1 (]: On model.airflow_agents_dbt.customer_summary: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "node_id": "model.airflow_agents_dbt.customer_summary"} */
alter table "dbt"."analytics"."customer_summary__dbt_tmp" rename to "customer_summary"
[0m00:37:57.268056 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:37:57.274339 [debug] [Thread-1 (]: On model.airflow_agents_dbt.customer_summary: COMMIT
[0m00:37:57.274651 [debug] [Thread-1 (]: Using postgres connection "model.airflow_agents_dbt.customer_summary"
[0m00:37:57.274782 [debug] [Thread-1 (]: On model.airflow_agents_dbt.customer_summary: COMMIT
[0m00:37:57.274519 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.013 seconds
[0m00:37:57.276803 [debug] [Thread-2 (]: Using postgres connection "model.airflow_agents_dbt.run_events"
[0m00:37:57.276984 [debug] [Thread-2 (]: On model.airflow_agents_dbt.run_events: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "node_id": "model.airflow_agents_dbt.run_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'run_events'
        
        and table_schema = 'analytics'
        
      order by ordinal_position

  
[0m00:37:57.277510 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m00:37:57.279880 [debug] [Thread-1 (]: Applying DROP to: "dbt"."analytics"."customer_summary__dbt_backup"
[0m00:37:57.280039 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.003 seconds
[0m00:37:57.281870 [debug] [Thread-1 (]: Using postgres connection "model.airflow_agents_dbt.customer_summary"
[0m00:37:57.286082 [debug] [Thread-1 (]: On model.airflow_agents_dbt.customer_summary: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "node_id": "model.airflow_agents_dbt.customer_summary"} */
drop table if exists "dbt"."analytics"."customer_summary__dbt_backup" cascade
[0m00:37:57.285838 [debug] [Thread-2 (]: Using postgres connection "model.airflow_agents_dbt.run_events"
[0m00:37:57.286292 [debug] [Thread-2 (]: On model.airflow_agents_dbt.run_events: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "node_id": "model.airflow_agents_dbt.run_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'run_events'
        
        and table_schema = 'analytics'
        
      order by ordinal_position

  
[0m00:37:57.287714 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m00:37:57.287913 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.001 seconds
[0m00:37:57.288912 [debug] [Thread-1 (]: On model.airflow_agents_dbt.customer_summary: Close
[0m00:37:57.294030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa8d0186-a357-4738-a29b-eff7c0c86aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab33d6d0>]}
[0m00:37:57.293179 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_agents_dbt.run_events"
[0m00:37:57.294396 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics.customer_summary ................... [[32mSELECT 3[0m in 0.08s]
[0m00:37:57.294833 [debug] [Thread-1 (]: Finished running node model.airflow_agents_dbt.customer_summary
[0m00:37:57.295221 [debug] [Thread-2 (]: Using postgres connection "model.airflow_agents_dbt.run_events"
[0m00:37:57.295545 [debug] [Thread-2 (]: On model.airflow_agents_dbt.run_events: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "node_id": "model.airflow_agents_dbt.run_events"} */

      insert into "dbt"."analytics"."run_events" ("run_started_at", "invocation_id")
    (
        select "run_started_at", "invocation_id"
        from "run_events__dbt_tmp003757242585"
    )


  
[0m00:37:57.296246 [debug] [Thread-2 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m00:37:57.296883 [debug] [Thread-2 (]: On model.airflow_agents_dbt.run_events: COMMIT
[0m00:37:57.297037 [debug] [Thread-2 (]: Using postgres connection "model.airflow_agents_dbt.run_events"
[0m00:37:57.297168 [debug] [Thread-2 (]: On model.airflow_agents_dbt.run_events: COMMIT
[0m00:37:57.297756 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m00:37:57.298068 [debug] [Thread-2 (]: On model.airflow_agents_dbt.run_events: Close
[0m00:37:57.298375 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa8d0186-a357-4738-a29b-eff7c0c86aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6bcb740>]}
[0m00:37:57.298678 [info ] [Thread-2 (]: 2 of 2 OK created sql incremental model analytics.run_events ................... [[32mINSERT 0 1[0m in 0.08s]
[0m00:37:57.299134 [debug] [Thread-2 (]: Finished running node model.airflow_agents_dbt.run_events
[0m00:37:57.300267 [debug] [MainThread]: On master: COMMIT
[0m00:37:57.300470 [debug] [MainThread]: Using postgres connection "master"
[0m00:37:57.300664 [debug] [MainThread]: On master: COMMIT
[0m00:37:57.300887 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:37:57.307189 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m00:37:57.307392 [debug] [MainThread]: On master: Close
[0m00:37:57.307691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:37:57.307840 [debug] [MainThread]: Connection 'model.airflow_agents_dbt.customer_summary' was properly closed.
[0m00:37:57.307951 [debug] [MainThread]: Connection 'model.airflow_agents_dbt.run_events' was properly closed.
[0m00:37:57.308082 [info ] [MainThread]: 
[0m00:37:57.308213 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m00:37:57.308580 [debug] [MainThread]: Command end result
[0m00:37:57.319055 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/include/dbt/target/manifest.json
[0m00:37:57.320087 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/include/dbt/target/semantic_manifest.json
[0m00:37:57.322499 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/include/dbt/target/run_results.json
[0m00:37:57.322669 [info ] [MainThread]: 
[0m00:37:57.322869 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:37:57.323007 [info ] [MainThread]: 
[0m00:37:57.323161 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m00:37:57.323683 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.42522642, "process_in_blocks": "0", "process_kernel_time": 0.083059, "process_mem_max_rss": "126976", "process_out_blocks": "1810", "process_user_time": 1.333953}
[0m00:37:57.323961 [debug] [MainThread]: Command `dbt run` succeeded at 00:37:57.323888 after 0.43 seconds
[0m00:37:57.324193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa973a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8a08620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8a09550>]}
[0m00:37:57.324378 [debug] [MainThread]: Flushing usage events
[0m00:37:58.112207 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:37:59.976228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff918dae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff912139e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff913479e0>]}


============================== 00:37:59.993351 | 97f63dcd-c546-4698-b906-698c93119723 ==============================
[0m00:37:59.993351 [info ] [MainThread]: Running with dbt=1.11.3
[0m00:37:59.993832 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'fail_fast': 'False', 'introspect': 'True', 'use_colors': 'True', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'no_print': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'invocation_command': 'dbt test', 'indirect_selection': 'eager', 'empty': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt'}
[0m00:38:00.084550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97f63dcd-c546-4698-b906-698c93119723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff916c07a0>]}
[0m00:38:00.105860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97f63dcd-c546-4698-b906-698c93119723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90f81eb0>]}
[0m00:38:00.106246 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m00:38:00.134708 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m00:38:00.177996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:38:00.178209 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m00:38:00.178358 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:38:00.195068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97f63dcd-c546-4698-b906-698c93119723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff903c4c20>]}
[0m00:38:00.225844 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/include/dbt/target/manifest.json
[0m00:38:00.226693 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/include/dbt/target/semantic_manifest.json
[0m00:38:00.296326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97f63dcd-c546-4698-b906-698c93119723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f6a6d50>]}
[0m00:38:00.296616 [info ] [MainThread]: Found 2 models, 1 seed, 1 test, 464 macros
[0m00:38:00.296938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97f63dcd-c546-4698-b906-698c93119723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9068eff0>]}
[0m00:38:00.297694 [info ] [MainThread]: 
[0m00:38:00.297922 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:38:00.298094 [info ] [MainThread]: 
[0m00:38:00.298379 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:38:00.300031 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_analytics'
[0m00:38:00.314670 [debug] [ThreadPool]: Using postgres connection "list_dbt_analytics"
[0m00:38:00.314885 [debug] [ThreadPool]: On list_dbt_analytics: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "list_dbt_analytics"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m00:38:00.315093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:00.322734 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m00:38:00.323413 [debug] [ThreadPool]: On list_dbt_analytics: ROLLBACK
[0m00:38:00.323852 [debug] [ThreadPool]: On list_dbt_analytics: Close
[0m00:38:00.326250 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:00.326447 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:38:00.326636 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:38:00.332830 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m00:38:00.333370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97f63dcd-c546-4698-b906-698c93119723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90610ef0>]}
[0m00:38:00.333604 [debug] [MainThread]: On master: ROLLBACK
[0m00:38:00.334103 [debug] [MainThread]: On master: COMMIT
[0m00:38:00.334259 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:00.334388 [debug] [MainThread]: On master: COMMIT
[0m00:38:00.335141 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:38:00.335275 [debug] [MainThread]: On master: Close
[0m00:38:00.336761 [debug] [Thread-1 (]: Began running node test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67
[0m00:38:00.337027 [info ] [Thread-1 (]: 1 of 1 START test not_null_customer_summary_customer_id ........................ [RUN]
[0m00:38:00.337249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_analytics, now test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67)
[0m00:38:00.337431 [debug] [Thread-1 (]: Began compiling node test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67
[0m00:38:00.343302 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67"
[0m00:38:00.343975 [debug] [Thread-1 (]: Began executing node test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67
[0m00:38:00.350302 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67"
[0m00:38:00.350942 [debug] [Thread-1 (]: Using postgres connection "test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67"
[0m00:38:00.351114 [debug] [Thread-1 (]: On test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "airflow_agents_dbt", "target_name": "dev", "node_id": "test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dbt"."analytics"."customer_summary"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m00:38:00.351266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:38:00.359394 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m00:38:00.361197 [debug] [Thread-1 (]: On test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67: ROLLBACK
[0m00:38:00.361730 [debug] [Thread-1 (]: On test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67: Close
[0m00:38:00.362082 [info ] [Thread-1 (]: 1 of 1 PASS not_null_customer_summary_customer_id .............................. [[32mPASS[0m in 0.02s]
[0m00:38:00.362410 [debug] [Thread-1 (]: Finished running node test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67
[0m00:38:00.363240 [debug] [MainThread]: On master: COMMIT
[0m00:38:00.363419 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:00.363555 [debug] [MainThread]: On master: COMMIT
[0m00:38:00.363694 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:38:00.368684 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m00:38:00.368867 [debug] [MainThread]: On master: Close
[0m00:38:00.369095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:38:00.369248 [debug] [MainThread]: Connection 'test.airflow_agents_dbt.not_null_customer_summary_customer_id.a81d32eb67' was properly closed.
[0m00:38:00.369416 [info ] [MainThread]: 
[0m00:38:00.369575 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m00:38:00.369903 [debug] [MainThread]: Command end result
[0m00:38:00.379607 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/include/dbt/target/manifest.json
[0m00:38:00.380499 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/include/dbt/target/semantic_manifest.json
[0m00:38:00.383072 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/include/dbt/target/run_results.json
[0m00:38:00.383218 [info ] [MainThread]: 
[0m00:38:00.383404 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:38:00.383544 [info ] [MainThread]: 
[0m00:38:00.383691 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:38:00.384261 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.42782766, "process_in_blocks": "0", "process_kernel_time": 0.083141, "process_mem_max_rss": "154844", "process_out_blocks": "1793", "process_user_time": 1.319248}
[0m00:38:00.384504 [debug] [MainThread]: Command `dbt test` succeeded at 00:38:00.384447 after 0.43 seconds
[0m00:38:00.384658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9090ce30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90cb1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f173020>]}
[0m00:38:00.384825 [debug] [MainThread]: Flushing usage events
[0m00:38:01.187042 [debug] [MainThread]: An error was encountered while trying to flush usage events
